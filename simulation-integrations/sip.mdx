---
title: 'SIP'
description: 'Connect directly via SIP and collect enhanced call metadata'
---

# Connecting via SIP

Bluejay supports direct SIP (Session Initiation Protocol) connectivity, allowing you to bypass the traditional PSTN (Public Switched Telephone Network) and establish direct connections to your voice agents. This approach provides enhanced control, reduced latency, and access to rich call metadata through custom headers.

## What is SIP?

SIP (Session Initiation Protocol) is a signaling protocol used for initiating, maintaining, and terminating real-time communication sessions. Unlike traditional PSTN calls that route through telephone networks, SIP enables direct IP-based communication between endpoints.

## How SIP Calls Connect

When you configure your agent for SIP connectivity, the call flow works as follows:

1. **SIP Invite**: Bluejay sends a SIP INVITE request to the voice agent endpoint
2. **Header Injection**: Bluejay automatically injects custom headers, including the `X-Simulation-Result-Id`
3. **Session Negotiation**: SIP protocols negotiate audio codecs, media parameters, and connection details
4. **Media Stream**: Direct RTP (Real-time Transport Protocol) audio streams are established
5. **Call Handling**: Your agent processes the call with full access to SIP headers and metadata
```mermaid
graph LR
    A[Bluejay Digital Human] -->|SIP INVITE| B[Your Voice Agent]
    B -->|SIP Headers + Metadata| C[Call Session]
    B -->|RTP Audio Stream| A
    C -->|Simulation Data| D[update-simulation-result API]
```

## `X-Simulation-Result-Id` Header

Bluejay automatically injects a critical header into every SIP INVITE request:

```
X-Simulation-Result-Id: <unique-simulation-result-id>
```

This header contains a unique identifier that links the specific call session to Bluejay's simulation and evaluation system.

### Header Usage in SIP INVITE

When your SIP system receives an incoming call from Bluejay, the complete SIP INVITE will include:

```sip
INVITE sip:your-endpoint@your-domain.com SIP/2.0
Via: SIP/2.0/UDP bluejay-sip-gateway.com:5060
From: <sip:agent@bluejay.ai>
To: <sip:your-endpoint@your-domain.com>
Call-ID: unique-call-identifier
X-Simulation-Result-Id: 1234
X-Call-Type: SIP
Content-Type: application/sdp
...
```

### Extracting the Header

Your SIP infrastructure can extract this header during call setup:

```python
# Example: Extracting header in Python/SIP library
def handle_sip_invite(invite_message):
    simulation_id = invite_message.headers.get('X-Simulation-Result-Id')
    if simulation_id:
        # Store for later use in updating simulation results
        store_simulation_id(simulation_id)
```

## Update Simulation Result Endpoint

The `X-Simulation-Result-Id` enables you to enrich your simulation data by calling the [`/v1/update-simulation-result`](/api-reference/endpoint/update-simulation-result) endpoint.

### Endpoint Details

`POST` [`/v1/update-simulation-result`](/api-reference/endpoint/update-simulation-result)

**Headers:**
- `Authorization: Bearer <your-api-key>`
- `Content-Type: application/json`

**Request Body:**
```json
{
  "simulation_result_id": "1234",
  "events": [
    {
      "event_type": "tool_call",
      "timestamp": "2024-01-15T10:30:00Z",
      "data": {
        "tool_name": "get_account_balance",
        "parameters": {"account_id": "12345"},
        "result": {"balance": 1500.00}
      }
    }
  ],
  "tool_calls": [
    {
      "tool_name": "transfer_funds",
      "parameters": {"from": "12345", "to": "67890", "amount": 500},
      "result": {"transaction_id": "txn_abc123", "status": "completed"},
      "timestamp": "2024-01-15T10:32:00Z"
    }
  ],
  "metadata": {
    "call_duration": 180,
    "customer_satisfaction": 5,
    "resolution_status": "resolved",
    "custom_tags": ["account_inquiry", "funds_transfer"]
  }
}
```

## Getting Started

1. **Configure SIP Endpoint**: Enable your infrastructure with a SIP URI to receive calls from Bluejay
2. **Extract Headers**: Implement header parsing to capture `X-Simulation-Result-Id`
3. **Track Interactions**: Log tool calls, events, and metadata throughout the call
4. **Update Results**: Use the [`/v1/update-simulation-result`](/api-reference/endpoint/update-simulation-result) endpoint to enrich your data
5. **Analyze Performance**: Leverage the enhanced data for improved agent evaluation and optimization

### What You Can Update

1. **Tool Calls**: Document every function/API call made during the conversation
2. **Events**: Track significant moments, state changes, or customer interactions  
3. **Tags**: Add categorical labels for filtering and analysis
4. **Metadata**: Include custom metrics, outcomes, and contextual information

## Customer Integration Benefits

By connecting via SIP and utilizing the simulation result updates, customers gain:

### Enhanced Evaluation Capabilities

- **Complete Tool Call Tracking**: Monitor every API call, database query, and external service interaction
- **Custom Metrics**: Define and track business-specific KPIs and success criteria
- **Event Timeline**: Build detailed timelines of customer interactions and agent decisions
- **Outcome Correlation**: Link conversation outcomes to specific tool usage patterns

For technical support with SIP configuration or integration questions, contact the Bluejay team.
